(this["webpackJsonpintegrated-quest-app-fe"]=this["webpackJsonpintegrated-quest-app-fe"]||[]).push([[4],{367:function(e,t,n){"use strict";n.r(t);var o=n(4),i=n(1),a=n(14),r=n(368),c=n(358),s=n(364),u=n(357),d=n(355),l=n(359),m=n(360),p={type:"change"},O={type:"start"},v={type:"end"},E=new c.pb(0,0,1),b=new c.j,f=new c.Z,w=new c.Z(-Math.sqrt(.5),0,0,Math.sqrt(.5)),h=function(e){Object(l.a)(n,e);var t=Object(m.a)(n);function n(e,o){var i;Object(u.a)(this,n),i=t.call(this),void 0===o&&console.warn('FirstPersonViewControls: The second parameter "domElement" is now mandatory.'),o===document&&console.error('FirstPersonViewControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),!1===window.isSecureContext&&console.error("FirstPersonViewControls: DeviceOrientationEvent is only available in secure contexts (https)"),i.object=e,i.object.rotation.reorder("YXZ"),i.domElement=o,i.domElement.style.touchAction="none",i.enabled=!0,i.target=new c.pb,i.minDistance=0,i.maxDistance=1/0,i.minZoom=0,i.maxZoom=1/0,i.minPolarAngle=0,i.maxPolarAngle=Math.PI,i.minAzimuthAngle=-1/0,i.maxAzimuthAngle=1/0,i.enableDamping=!1,i.dampingFactor=.05,i.enableFOVZoom=!0,i.zoomMinFOV=5,i.zoomMaxFOV=75,i.enableRotate=!0,i.rotateSpeed=1,i.mouseButtons={LEFT:c.E.ROTATE,MIDDLE:c.E.NONE,RIGHT:c.E.NONE},i.touches={ONE:c.ib.NONE,TWO:c.ib.NONE},i.target0=i.target.clone(),i.position0=i.object.position.clone(),i.zoom0=i.object.zoom;var a=new c.Z;i.enabledDeviceOrientation=!0,i.deviceOrientation={},i.screenOrientationDevOr=0,i.alphaOffsetDevOr=0,i.reset=function(){r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(p),r.update(),l=s.NONE},i.update=function(){!0===r.enabledDeviceOrientation&&r.updateDeviceOrientation()},i.dispose=function(){r.domElement.removeEventListener("pointerdown",L),r.domElement.removeEventListener("pointercancel",M),r.domElement.removeEventListener("wheel",V),r.domElement.ownerDocument.removeEventListener("pointermove",R),r.domElement.ownerDocument.removeEventListener("pointerup",A),r.disconnectDeviceOrientation()};var r=Object(d.a)(i),s={NONE:-1,ROTATE:0,DOLLY:1,TOUCH_ROTATE:3,TOUCH_DOLLY_ROTATE:6,ZOOM_FOV:7},l=s.NONE,m=new c.ob,h=new c.ob,g=new c.ob,T=new c.ob,D=new c.ob,N=[],j={};function y(e,t){var n=(new c.j).copy(r.object.rotation),o=n.x+t,i=n.y+e;r.object.rotation.set(o,i,n.z,"YZX")}function F(e){if(r.object.isPerspectiveCamera){var t=Math.min(Math.max(r.object.fov+e,r.zoomMinFOV),r.zoomMaxFOV);r.object.fov=t,r.object.updateProjectionMatrix()}else console.error("Only perspective camera is supported")}function L(e){!1!==r.enabled&&(0===N.length&&(r.domElement.ownerDocument.addEventListener("pointermove",R),r.domElement.ownerDocument.addEventListener("pointerup",A)),function(e){N.push(e)}(e),"touch"===e.pointerType?function(e){switch(Z(e),N.length){case 1:switch(r.touches.ONE){case c.ib.ROTATE:if(!1===r.enableRotate)return;!function(){if(1===N.length)m.set(N[0].pageX,N[0].pageY);else{var e=.5*(N[0].pageX+N[1].pageX),t=.5*(N[0].pageY+N[1].pageY);m.set(e,t)}}(),l=s.TOUCH_ROTATE;break;default:l=s.NONE}break;case 2:switch(r.touches.TWO){case 100:if(!1===r.enableFOVZoom)return;!function(){if(r.enableFOVZoom){var e=N[0].pageX-N[1].pageX,t=N[0].pageY-N[1].pageY,n=Math.sqrt(e*e+t*t);T.set(0,n)}}(),l=s.ZOOM_FOV;break;default:l=s.NONE}break;default:l=s.NONE}l!==s.NONE&&r.dispatchEvent(O)}(e):function(e){var t;switch(e.button){case 0:t=r.mouseButtons.LEFT;break;case 1:t=r.mouseButtons.MIDDLE,console.log("select middle mouse action");break;case 2:t=r.mouseButtons.RIGHT;break;default:t=-1}switch(t){case c.E.ROTATE:if(!1===r.enableRotate)return;!function(e){m.set(e.clientX,e.clientY)}(e),l=s.ROTATE;break;default:l=s.NONE}l!==s.NONE&&r.dispatchEvent(O)}(e))}function R(e){!1!==r.enabled&&("touch"===e.pointerType?function(e){switch(Z(e),l){case s.ZOOM_FOV:if(!1===r.enableFOVZoom)return;!function(e){if(r.enableFOVZoom){var t=Y(e),n=e.pageX-t.x,o=e.pageY-t.y,i=Math.sqrt(n*n+o*o);D.set(0,i);var a=Math.max(.1,(r.object.fov-r.zoomMinFOV)/(r.zoomMaxFOV-r.zoomMinFOV));D.y>T.y?F(-a):F(a),T.copy(D)}}(e);break;case s.TOUCH_ROTATE:if(!1===r.enableRotate)return;!function(e){if(1===N.length)h.set(e.pageX,e.pageY);else{var t=Y(e),n=.5*(e.pageX+t.x),o=.5*(e.pageY+t.y);h.set(n,o)}g.subVectors(h,m).multiplyScalar(r.rotateSpeed);var i=r.domElement,a=g.x/i.clientHeight,c=g.y/i.clientHeight;m.copy(h),y(a,c)}(e),r.update();break;default:l=s.NONE}}(e):function(e){if(!1===r.enabled)return;switch(l){case s.ROTATE:if(!1===r.enableRotate)return;!function(e){h.set(e.clientX,e.clientY),g.subVectors(h,m).multiplyScalar(r.rotateSpeed);var t=r.domElement,n=g.x/t.clientHeight,o=g.y/t.clientHeight;m.copy(h),y(n,o)}(e)}}(e))}function A(e){!1!==r.enabled&&(e.pointerType,r.dispatchEvent(v),l=s.NONE,x(e),0===N.length&&(r.domElement.ownerDocument.removeEventListener("pointermove",R),r.domElement.ownerDocument.removeEventListener("pointerup",A)))}function M(e){x(e)}function V(e){!1===r.enabled||!1===r.enableFOVZoom||l!==s.NONE&&l!==s.ROTATE||(e.preventDefault(),r.dispatchEvent(O),function(e){e.deltaY<0?r.enableFOVZoom&&F(-5):e.deltaY>0&&r.enableFOVZoom&&F(5),r.update()}(e),r.dispatchEvent(v))}function x(e){delete j[e.pointerId];for(var t=0;t<N.length;t++)if(N[t].pointerId===e.pointerId)return void N.splice(t,1)}function Z(e){var t=j[e.pointerId];void 0===t&&(t=new c.ob,j[e.pointerId]=t),t.set(e.pageX,e.pageY)}function Y(e){var t=e.pointerId===N[0].pointerId?N[1]:N[0];return j[t.pointerId]}var I=function(e){r.deviceOrientation=e},z=function(){r.screenOrientationDevOr=window.orientation||0};return i.connectDeviceOrientation=function(){z(),void 0!==window.DeviceOrientationEvent&&"function"===typeof window.DeviceOrientationEvent.requestPermission?window.DeviceOrientationEvent.requestPermission().then((function(e){"granted"===e&&(window.addEventListener("orientationchange",z),window.addEventListener("deviceorientation",I))})).catch((function(e){console.error("THREE.MyDeviceOrientationControls: Unable to use DeviceOrientation API:",e)})):(window.addEventListener("orientationchange",z),window.addEventListener("deviceorientation",I)),r.enabledDeviceOrientation=!0},i.disconnectDeviceOrientation=function(){window.removeEventListener("orientationchange",z),window.removeEventListener("deviceorientation",I),r.enabledDeviceOrientation=!1},i.updateDeviceOrientation=function(){if(!1!==r.enabledDeviceOrientation){var e=r.deviceOrientation;if(e){var t=e.alpha?c.G.degToRad(e.alpha)+r.alphaOffsetDevOr:0,n=e.beta?c.G.degToRad(e.beta):0,o=e.gamma?c.G.degToRad(e.gamma):0,i=r.screenOrientationDevOr?c.G.degToRad(r.screenOrientationDevOr):0;!function(e,t,n,o,i){b.set(n,t,-o,"YXZ"),e.setFromEuler(b),e.multiply(w),e.multiply(f.setFromAxisAngle(E,-i))}(r.object.quaternion,t,n,o,i),8*(1-a.dot(r.object.quaternion))>1e-6&&(a.copy(r.object.quaternion),r.dispatchEvent(p))}}},r.domElement.addEventListener("pointerdown",L),r.domElement.addEventListener("pointercancel",M),r.domElement.addEventListener("wheel",V,{passive:!1}),i.connectDeviceOrientation(),i}return n}(c.k),g=n(61),T=n(60),D=n.p+"static/media/gallery_room.b9330f65.glb",N=n(0);t.default=function(){var e=Object(i.useState)(!1),t=Object(o.a)(e,2),n=t[0],u=t[1],d=Object(i.useState)(!1),l=Object(o.a)(d,2),m=l[0],p=l[1],O=Object(i.useState)(!1),v=Object(o.a)(O,2),E=v[0],b=v[1],f=Object(a.h)().state.resources.map((function(e){return{queryKey:["resourceUrl",e],cacheTime:0,staleTime:1/0,queryFn:function(){return Object(g.c)(e).then((function(e){return new Promise((function(t){var n=new FileReader;n.onload=function(){n.result&&"string"===typeof n.result&&t(n.result)},n.readAsDataURL(e)}))}))}}})),w=Object(r.a)(f);Object(i.useEffect)((function(){!n&&w.every((function(e){return e.isFetched}))&&(u(!0),function(e,t,n,o,i){var a=new c.db,r=new c.U(75,window.innerWidth/window.innerHeight,1,3e3);r.position.y=225;var u=new c.rb({antialias:!0});u.setSize(window.innerWidth,window.innerHeight),u.outputEncoding=c.sb,e.appendChild(u.domElement);var d=new h(r,u.domElement);d.enableFOVZoom=!0,d.mouseButtons.LEFT=c.E.ROTATE,d.mouseButtons.MIDDLE=c.E.NONE,d.mouseButtons.RIGHT=c.E.NONE,d.touches.ONE=c.ib.NONE,d.touches.TWO=100,d.enabledDeviceOrientation=window.DeviceOrientationEvent&&"ontouchstart"in window,d.update();var l=new c.D,m=new c.lb(l),p=t.map((function(e){return new c.K({map:m.load(e)})}));new s.a(l).load(n,(function(e){o&&o(),a.add(e.scene)})),l.onLoad=function(){i&&i();for(var e=0;e<6;++e){var t="canvas"+(e+1),n=a.getObjectByName(t,!0);n.material=p[e];var o=n.material.map.image.width,r=n.material.map.image.height,c=o/r;o>r?n.scale.y/=c:n.scale.x*=c}},function e(){window.requestAnimationFrame(e),d.update(),u.render(a,r)}()}(j.current,w.map((function(e){return e.data})),D,(function(){return p(!0)}),(function(){return b(!0)})))}),[n,w]);var j=Object(i.useRef)(null);return Object(N.jsx)("div",{ref:j,children:Object(N.jsx)(T.a,{isLoading:w.every((function(e){return e.isFetching}))||!m||!E})})}}}]);
//# sourceMappingURL=4.7cc36413.chunk.js.map